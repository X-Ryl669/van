{let e,t,r,o,l,n,s,i,f,a,h,w,d,_,u,c,g,v,y,m,x,V,b,P,S,T,j,p,C,E;i=(s=Object).getPrototypeOf,a={},h=i(f={isConnected:1}),w=i(i),d="remove",_="eventListener",u=Set,c=document,g=(e,t,r,o)=>(e??(setTimeout(r,o),new u)).add(t),v=(e,t,o)=>{let l=r;r=t;try{return e(o)}catch(e){return console.error(e),o}finally{r=l}},y=e=>e.filter(e=>e.t?.isConnected),m=e=>l=g(l,e,()=>{for(let e of l)e.o=y(e.o),e.l=y(e.l);l=n},1e3),x={get val(){return r?.i?.add(this),this.rawVal},get oldVal(){return r?.i?.add(this),this.h},set val(o){r?._?.add(this),o!==this.rawVal&&(this.rawVal=o,this.o.length+this.l.length?(t?.add(this),e=g(e,this,C)):this.h=o)}},V=e=>({__proto__:x,rawVal:e,h:e,o:[],l:[]}),b=(e,t)=>{let r={i:new u,_:new u},l={f:e},n=o;o=[];let s=v(e,r,t);s=(s??c).nodeType?s:new Text(s);for(let e of r.i)r._.has(e)||(m(e),e.o.push(l));for(let e of o)e.t=s;return o=n,l.t=s},P=(e,t=V(),r)=>{let l={i:new u,_:new u},n={f:e,s:t};n.t=r??o?.push(n)??f,t.val=v(e,l,t.rawVal);for(let e of l.i)l._.has(e)||(m(e),e.l.push(n));return t},S=(e,...t)=>{for(let r of t.flat(1/0)){let t=i(r??0),o=t===x?b(()=>r.val):t===w?b(r):r;o!=n&&e.append(o)}return e},T=(e,t,...r)=>{let[o,...l]=i(r[0]??0)===h?r:[{},...r],f=c["createElement"+e&&"NS"](e||t,t);for(let[e,r]of s.entries(o)){let o=t=>t?s.getOwnPropertyDescriptor(t,e)??o(i(t)):n,l=t+","+e,h=a[l]??=o(i(f))?.set??0,u=e.startsWith("on"),c=u?(t,r)=>{let o=e.slice(2);f[d+_](o,r),f["add"+_](o,t)}:h?h.bind(f):f.setAttribute.bind(f,e),g=i(r??0);u||g===w&&(r=P(r),g=x),g===x?b(()=>(c(r.val,r.h),f)):c(r)}return S(f,l)},j=e=>({get:(t,r)=>T.bind(n,e,r)}),p=(e,t)=>t===e||e[t?"replaceWith":d](t),C=()=>{let r=0,o=[...e].filter(e=>e.rawVal!==e.h);do{t=new u;for(let e of new u(o.flatMap(e=>e.l=y(e.l))))P(e.f,e.s,e.t),e.t=n}while(++r<100&&(o=[...t]).length);let l=[...e].filter(e=>e.rawVal!==e.h);e=n;for(let e of new u(l.flatMap(e=>e.o=y(e.o))))p(e.t,b(e.f,e.t)),e.t=n;for(let e of l)e.h=e.rawVal},E={tags:new Proxy(e=>new Proxy(T,j(e)),j()),hydrate:(e,t)=>p(e,b(t,e)),add:S,state:V,derive:P},window.van=E;}